#  ä»»åŠ¡ä¸‰ï¼šæ™ºèƒ½æŠ¥å‘Šç”Ÿæˆ 
## åˆ‡æ¢è‡³ [Debuggeræ¨¡å¼]
##  å¾…æ‰§è¡ŒæŒ‡ä»¤ï¼š  
- [ ] åˆ›å»º `step3_report.py`  
- [ ] è¯»å– `{work_dir}/*.json` å³éœ€å…ˆå¤„ç†æ‰€æœ‰æµ‹è¯•ç»“æœæ–‡ä»¶ï¼Œæå–æœ‰æ•ˆæ•°æ®
- [ ] è®¡ç®—ï¼š  
  - æ¥å£è¦†ç›–ç‡ = å·²æµ‹æ¥å£æ•° / æ€»æ¥å£æ•°  
  - é‰´æƒç»•è¿‡æ•°ï¼šæµ‹è¯•2æˆ–3è¿”å› 2xx çš„æ¥å£  
  - å´©æºƒæ¥å£æ•°ï¼šæµ‹è¯•4è¿”å› 500 çš„æ¥å£  
- [ ] å‘ `{work_dir}/Final_Report.md` è¿½åŠ ä»¥ä¸‹å†…å®¹ï¼š  
- [ ] æ ¸å¿ƒæŒ‡æ ‡ç»Ÿè®¡é€»è¾‘ (Metrics Logic)  

  - éå†æµ‹è¯•ç»“æœï¼Œè®¡ç®—ä»¥ä¸‹è®¡æ•°å™¨ï¼š  
    - Total Requests: æ€»è¯·æ±‚æ•°ã€‚  
    - Network Fail: HTTP çŠ¶æ€é 200 çš„æ•°é‡ï¼ˆç¯å¢ƒé—®é¢˜ï¼‰ã€‚  
    - High Risk (Auth Bypass): ç»Ÿè®¡ test_type="no_auth" ä¸” business_code == 200 çš„æ•°é‡ï¼ˆè¿™æ˜¯æœ€ä¸¥é‡çš„è¶Šæƒæ¼æ´ï¼‰ã€‚  
    - System Crash: ç»Ÿè®¡ business_code == 500 çš„æ•°é‡ã€‚  
    - Pass Rate: (ç¬¦åˆé¢„æœŸçš„ç”¨ä¾‹æ•° / æ€»ç”¨ä¾‹æ•°) * 100%ã€‚  

      - æ³¨æ„ï¼šå¯¹äºæ— é‰´æƒæµ‹è¯•ï¼Œcode 401 ç®—â€œç¬¦åˆé¢„æœŸ (Pass)â€ï¼Œcode 200 ç®—â€œå¤±è´¥ (Fail)â€ã€‚  

---  
---  
###  æŠ¥å‘Šç”Ÿæˆæ¨¡æ¿ (Markdown Template)  
ä½ çš„ Python è„šæœ¬åº”è¯¥åŠ¨æ€å¡«å…… {} ä¸­çš„å˜é‡ã€‚ä»¥ä¸‹æ˜¯æœ€ç»ˆç”Ÿæˆçš„ Markdown æ–‡ä»¶ç»“æ„ç¤ºä¾‹ï¼š  
```markdown

# è‡ªåŠ¨åŒ–åç«¯æ¥å£å®‰å…¨æµ‹è¯•æŠ¥å‘Š

> **ç”Ÿæˆæ—¶é—´**: {report_time}
> **ç›®æ ‡ç³»ç»Ÿ**: {base_url}
> **æ£€æµ‹å¼•æ“**: AI-DevSecOps-Bot 

---

## 1. æµ‹è¯•æ¦‚è§ˆ (Executive Summary)
| æ ¸å¿ƒæŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
| :--- | :--- | :--- |
| **æ¥å£æ€»æ•°** | {total_apis} | æ‰«æåˆ°çš„ API æ•°é‡ |
| **æ‰§è¡Œç”¨ä¾‹** | {total_cases} | å®é™…å‘èµ·çš„æµ‹è¯•è¯·æ±‚æ€»æ•° |
| **é€šè¿‡ç‡** | **{pass_rate}%** | ç¬¦åˆé¢„æœŸçš„æµ‹è¯•æ¯”ä¾‹ |
| **é«˜å±æ¼æ´** | **{high_risk_count}** | **é‰´æƒç»•è¿‡ (è¶Šæƒ) æ•°é‡** |
| **ç³»ç»Ÿå´©æºƒ** | {crash_count} | ä¸šåŠ¡è¿”å› Code 500 çš„æ•°é‡ |
| **ç½‘ç»œé”™è¯¯** | {net_err_count} | HTTP å±‚é 200 çš„æ•°é‡ |

---

## 2. æµ‹è¯•ç”¨ä¾‹ç»Ÿè®¡æ¦‚è§ˆ
| æµ‹è¯•ç±»å‹	|æ€»æ•°	|é€šè¿‡æ•°	|å¤±è´¥æ•°	|é€šè¿‡ç‡ |
| :--- | :--- | :--- | :--- | :--- |
| åŸºå‡†æµ‹è¯• (basic_auth)	|{metrics['type_stats'].get('basic_auth', {}).get('total', 0)}	|{metrics['type_stats'].get('basic_auth', {}).get('passed', 0)}	|{metrics['type_stats'].get('basic_auth', {}).get('failed', 0)}	|{metrics['type_stats'].get('basic_auth', {}).get('rate', 0)}%|
| è¶Šæƒæµ‹è¯• (no_auth)	|{metrics['type_stats'].get('no_auth', {}).get('total', 0)}	|{metrics['type_stats'].get('no_auth', {}).get('passed', 0)}	|{metrics['type_stats'].get('no_auth', {}).get('failed', 0)}	|{metrics['type_stats'].get('no_auth', {}).get('rate', 0)}%
| å¥å£®æ€§æµ‹è¯• (fuzz)	|{metrics['type_stats'].get('fuzz', {}).get('total', 0)}	|{metrics['type_stats'].get('fuzz', {}).get('passed', 0)}	|{metrics['type_stats'].get('fuzz', {}).get('failed', 0)}	|{metrics['type_stats'].get('fuzz', {}).get('rate', 0)}%
| è¾¹ç•Œå€¼æµ‹è¯• (boundary)	|{metrics['type_stats'].get('boundary', {}).get('total', 0)}	|{metrics['type_stats'].get('boundary', {}).get('passed', 0)}	|{metrics['type_stats'].get('boundary', {}).get('failed', 0)}	|{metrics['type_stats'].get('boundary', {}).get('rate', 0)}%
| æ€»è®¡	|{metrics['total_requests']}	|{metrics['overall_passed']}	|{metrics['overall_failed']}	|{metrics['overall_rate']}%

---


## 3. è¯¦ç»†æµ‹è¯•ç»“æœï¼ˆéœ€è¦æ¯ä¸ªæ–¹å‘ç»™å‡ºè‡³å°‘15ä¸ªå…¸å‹ç”¨ä¾‹çš„è¿”å›ç»“æœï¼‰
### 3.1 é€šè¿‡ç”¨ä¾‹æ¦‚å†µ
æˆåŠŸè¯·æ±‚: {metrics['success_requests']} æ¬¡ (HTTP 200 ä¸”ä¸šåŠ¡ç æ­£å¸¸)  
é‰´æƒé€šè¿‡: {metrics['auth_passed']} æ¬¡ (å¸¦è®¤è¯è¯·æ±‚æ­£å¸¸è¿”å›)  
å¼‚å¸¸è¯·æ±‚å¤„ç†æ­£å¸¸: {metrics['exception_handled']} æ¬¡ (å¼‚å¸¸è¾“å…¥è¢«æ­£ç¡®å¤„ç†)  
æ— æƒé™éªŒè¯æ­£ç¡®: {metrics['no_auth_correct']} æ¬¡ (æ— è®¤è¯è¯·æ±‚æ­£ç¡®è¿”å›401/403)  
#### 3.1.1 é‰´æƒé€šè¿‡æ¥å£è¯¦æƒ…
|æ¥å£è·¯å¾„ (URL)	æ–¹æ³•	|æµ‹è¯•ç±»å‹	|Payload (å¤ç°å‚æ•°)	|å®é™…ä¸šåŠ¡ç 	|æœåŠ¡ç«¯æç¤º|

### 3.2 å¤±è´¥ç”¨ä¾‹ä¸å¤±è´¥æè¿°
#### 3.2.1 é«˜é£é™©æ¥å£è¯¦æƒ…
|æ¥å£è·¯å¾„ (URL)	æ–¹æ³•	|æµ‹è¯•ç±»å‹	|å®é™…ä¸šåŠ¡ç 	|æœåŠ¡ç«¯æç¤º (Evidence)	|é£é™©æè¿°|
|            |          |              |           | {high_risk_details}|					
##### 3.2.2 ç³»ç»Ÿå¥å£®æ€§é—®é¢˜
é£é™©å®šä¹‰: ç‰¹æ®Šè¾“å…¥å¯¼è‡´æœåŠ¡ç«¯æŠ›å‡ºå¼‚å¸¸ (Code 500)ï¼Œå¯èƒ½æš´éœ²å †æ ˆä¿¡æ¯ã€‚

|æ¥å£è·¯å¾„ (URL)	æ–¹æ³•	|æµ‹è¯•ç±»å‹	|Payload (å¤ç°å‚æ•°)	 |å®é™…ä¸šåŠ¡ç 	|æœåŠ¡ç«¯æç¤º
|                    |        |                    |           | {crash_details}				
#### 3.2.3 å…¶ä»–å¤±è´¥ç”¨ä¾‹
|æ¥å£è·¯å¾„ (URL)	æ–¹æ³•	|æµ‹è¯•ç±»å‹	|	é¢„æœŸç»“æœ	|å®é™…ç»“æœ	|å¤±è´¥æè¿°
|                    |        |          |         |{other_failure_rows}					

---

## 4.  å®‰å…¨ç»“è®ºä¸å»ºè®®

### 4.1 é‰´æƒé€»è¾‘åˆ†æ
* **é¢„æœŸè¡Œä¸º**: æœªç™»å½•è®¿é—®åº”è¿”å› `Code: 401`, Msg: `"è®¤è¯å¤±è´¥"`ã€‚  
* **å®é™…å‘ç°**: å…±å‘ç° **{high_risk_count}** ä¸ªæ¥å£ä¸ç¬¦åˆé¢„æœŸã€‚  

### 4.2 ä¿®å¤å»ºè®®
1. **å¼ºåˆ¶é‰´æƒ**: æ£€æŸ¥ `Shiro/SpringSecurity` é…ç½®ï¼Œç¡®ä¿ä¸Šè¿°æ¥å£æœªè¢«æ’é™¤åœ¨è¿‡æ»¤å™¨ä¹‹å¤–ã€‚  
2. **å¼‚å¸¸æ•è·**: å¯¹ 500 é”™è¯¯æ¥å£å¢åŠ å…¨å±€å¼‚å¸¸å¤„ç† (GlobalExceptionHandler)ï¼Œé¿å…å †æ ˆå¤–éœ²ã€‚  

---
```

### å…³é”®ç‚¹è§£æ (å¯¹äº Python å®ç°)  
åœ¨ç¼–å†™ step3_report.py ç”Ÿæˆä¸Šè¿° Markdown è¡¨æ ¼æ—¶ï¼Œé‡ç‚¹å…³æ³¨ 2.1 é‰´æƒç»•è¿‡ è¡¨æ ¼çš„è¿™ä¸€è¡Œé€»è¾‘ï¼š  

```Python
# ä¼ªä»£ç ï¼šå¦‚ä½•å†³å®šæ˜¯å¦å°†ä¸€æ¡ç»“æœå†™å…¥"é‰´æƒç»•è¿‡"è¡¨æ ¼
if result['test_type'] == 'no_auth':
    if result['business_code'] == 200:
        # è¿™æ˜¯ä¸€ä¸ªæ¼æ´ï¼å†™å…¥è¡¨æ ¼
        write_row(
            url=result['url'],
            code=f"ğŸ”´ {result['business_code']}", 
            evidence=f"\"{result['server_message']}\"", # åŠ ä¸Šå¼•å·å¼ºè°ƒ
            desc="æœªé‰´æƒæ“ä½œæˆåŠŸ"
        )
    elif result['business_code'] == 401:
        # è¿™æ˜¯å®‰å…¨çš„ï¼Œä¸å†™å…¥"å¤±è´¥è¯¦æƒ…"è¡¨ï¼Œè®¡å…¥é€šè¿‡ç‡å³å¯
        pass

```
- [ ] æ‰“å°å®Œæˆæç¤ºï¼š`âœ… æŠ¥å‘Šå·²ç”Ÿæˆï¼š{work_dir}/Final_Report.md`  
---