# 报告生成模板 (Markdown Template)  
## 读取 `{work_dir}/*.json` 即需先处理所有测试结果文件，提取有效数据（“*”代指所有测试结果文件）
以下是最终生成的 Markdown 文件结构示例：  
```markdown

# 自动化后端接口安全测试报告

> **生成时间**: {report_time}
> **目标系统**: {base_url}
> **检测引擎**: AI-DevSecOps-Bot 

---

## 1. 测试概览 (Executive Summary)
| 核心指标 | 数值 | 说明 |
| :--- | :--- | :--- |
| **接口总数** | {total_apis} | 扫描到的 API 数量 |
| **执行用例** | {total_cases} | 实际发起的测试请求总数 |
| **通过率** | **{pass_rate}%** | 符合预期的测试比例 |
| **高危漏洞** | **{high_risk_count}** | **鉴权绕过 (越权) 数量** |
| **系统崩溃** | {crash_count} | 业务返回 Code 500 的数量 |
| **网络错误** | {net_err_count} | HTTP 层非 200 的数量 |

---

## 2. 测试用例统计概览
| 测试类型	|总数	|通过数	|失败数	|通过率 |
| :--- | :--- | :--- | :--- | :--- |
| 基准测试 (basic_auth)	|{metrics['type_stats'].get('basic_auth', {}).get('total', 0)}	|{metrics['type_stats'].get('basic_auth', {}).get('passed', 0)}	|{metrics['type_stats'].get('basic_auth', {}).get('failed', 0)}	|{metrics['type_stats'].get('basic_auth', {}).get('rate', 0)}%|
| 越权测试 (no_auth)	|{metrics['type_stats'].get('no_auth', {}).get('total', 0)}	|{metrics['type_stats'].get('no_auth', {}).get('passed', 0)}	|{metrics['type_stats'].get('no_auth', {}).get('failed', 0)}	|{metrics['type_stats'].get('no_auth', {}).get('rate', 0)}%
| 健壮性测试 (fuzz)	|{metrics['type_stats'].get('fuzz', {}).get('total', 0)}	|{metrics['type_stats'].get('fuzz', {}).get('passed', 0)}	|{metrics['type_stats'].get('fuzz', {}).get('failed', 0)}	|{metrics['type_stats'].get('fuzz', {}).get('rate', 0)}%
| 边界值测试 (boundary)	|{metrics['type_stats'].get('boundary', {}).get('total', 0)}	|{metrics['type_stats'].get('boundary', {}).get('passed', 0)}	|{metrics['type_stats'].get('boundary', {}).get('failed', 0)}	|{metrics['type_stats'].get('boundary', {}).get('rate', 0)}%
| 总计	|{metrics['total_requests']}	|{metrics['overall_passed']}	|{metrics['overall_failed']}	|{metrics['overall_rate']}%

---


## 3. 详细测试结果（需要每个方向给出至少15个典型用例的返回结果）
### 3.1 通过用例概况
成功请求: {metrics['success_requests']} 次 (HTTP 200 且业务码正常)  
鉴权通过: {metrics['auth_passed']} 次 (带认证请求正常返回)  
异常请求处理正常: {metrics['exception_handled']} 次 (异常输入被正确处理)  
无权限验证正确: {metrics['no_auth_correct']} 次 (无认证请求正确返回401/403)  
#### 3.1.1 基准测试通过接口详情
|接口路径 (URL)	方法	|测试类型	|Payload (复现参数)	|实际业务码	|服务端提示|
#### 3.1.2 越权测试通过接口详情描述
|接口路径 (URL)	方法	|测试类型	|Payload (复现参数)	|实际业务码	|服务端提示|
#### 3.1.3 健壮测试通过接口详情描述
|接口路径 (URL)	方法	|测试类型	|Payload (复现参数)	|实际业务码	|服务端提示|
#### 3.1.4 边界值测试通过接口详情描述
|接口路径 (URL)	方法	|测试类型	|Payload (复现参数)	|实际业务码	|服务端提示|
### 3.2 失败用例与失败描述
#### 3.2.1 高风险接口详情
|接口路径 (URL)	方法	|测试类型	|实际业务码	|服务端提示 (Evidence)	|风险描述|
|            |          |              |           | {high_risk_details}|					
##### 3.2.2 系统健壮性问题
风险定义: 特殊输入导致服务端抛出异常 (Code 500)，可能暴露堆栈信息。

|接口路径 (URL)	方法	|测试类型	|Payload (复现参数)	 |实际业务码	|服务端提示
|                    |        |                    |           | {crash_details}				
#### 3.2.3 其他失败用例
|接口路径 (URL)	方法	|测试类型	|	预期结果	|实际结果	|失败描述
|                    |        |          |         |{other_failure_rows}					

---

## 4.  安全结论与建议

### 4.1 鉴权逻辑分析
* **预期行为**: 未登录访问应返回 `Code: 401`, Msg: `"认证失败"`。  
* **实际发现**: 共发现 **{high_risk_count}** 个接口不符合预期。  

### 4.2 修复建议
1. **强制鉴权**: 检查 `Shiro/SpringSecurity` 配置，确保上述接口未被排除在过滤器之外。  
2. **异常捕获**: 对 500 错误接口增加全局异常处理 (GlobalExceptionHandler)，避免堆栈外露。  

---
```

