# 自动化后端接口安全测试报告

> **生成时间**: 2026-01-04 20:55:26
> **目标系统**: http://192.168.142.146/
> **检测引擎**: AI-DevSecOps-Bot

---

## 1. 测试概览 (Executive Summary)

| 核心指标 | 数值 | 说明 |
| :--- | :--- | :--- |
| **接口总数** | 94 | 扫描到的 API 数量 |
| **执行用例** | 94 | 实际发起的测试请求总数 |
| **通过率** | **36.2%** | 符合预期的测试比例 |
| **高危漏洞** | **0** | 鉴权绕过 (越权) 数量 |
| **系统崩溃** | 26 | 业务返回 Code 500 的数量 |
| **网络错误** | 0 | HTTP 层非 200 的数量 |

---

## 2. 测试用例统计概览

| 测试类型 | 总数 | 通过数 | 失败数 | 通过率 |
| :--- | :--- | :--- | :--- | :--- |
| 基准测试 (basic_auth) | 94 | 34 | 26 | 36.2% |
| 越权测试 (no_auth) | 0 | 0 | 0 | 0% |
| 健壮性测试 (fuzz) | 0 | 0 | 0 | 0% |
| 边界值测试 (boundary) | 0 | 0 | 0 | 0% |
| 总计 | 94 | 34 | 26 | 36.2% |

---

## 3. 详细测试结果

### 3.1 通过用例概况

成功请求: 34 次 (HTTP 200 且业务码正常)  
鉴权通过: 34 次 (带认证请求正常返回)  
异常请求处理正常: 0 次 (异常输入被正确处理)  
无权限验证正确: 0 次 (无认证请求正确返回401/403)  

#### 3.1.1 基准测试通过接口详情

| 接口路径 (URL) | 方法 | 测试类型 | Payload (复现参数) | 实际业务码 | 服务端提示 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `/captchaImage` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/common/upload` | POST | basic_auth | multipart/form-data | 200 | 操作成功 |
| `/monitor/cache` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/monitor/cache/getNames` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/monitor/cache/getKeys/1` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/monitor/cache/getValue/1/1` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/monitor/server` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/monitor/logininfor/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/monitor/logininfor/unlock/{userName}` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/monitor/operlog/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/monitor/online/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/config/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/dept/list` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/system/dict/data/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/dict/type/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/dict/type/optionselect` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/getInfo` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/getRouters` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/system/menu/list` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/system/menu/treeselect` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/system/notice/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/post/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/post/optionselect` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/system/role/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/role/optionselect` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/role/authUser/allocatedList` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/role/authUser/unallocatedList` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/user/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/system/user/deptTree` | GET | basic_auth | 无需Payload | 200 | 操作成功 |
| `/tool/gen/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/tool/gen/db/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/tool/gen/batchGenCode` | GET | basic_auth | 无需Payload | 200 | Binary/Stream Response |
| `/monitor/job/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |
| `/monitor/jobLog/list` | GET | basic_auth | 无需Payload | 200 | 查询成功 |

#### 3.1.2 越权测试通过接口详情描述

| 接口路径 (URL) | 方法 | 测试类型 | Payload (复现参数) | 实际业务码 | 服务端提示 |

#### 3.1.3 健壮测试通过接口详情描述

| 接口路径 (URL) | 方法 | 测试类型 | Payload (复现参数) | 实际业务码 | 服务端提示 |

#### 3.1.4 边界值测试通过接口详情描述

| 接口路径 (URL) | 方法 | 测试类型 | Payload (复现参数) | 实际业务码 | 服务端提示 |

### 3.2 失败用例与失败描述

#### 3.2.1 高风险接口详情

| 接口路径 (URL) | 方法 | 测试类型 | 实际业务码 | 服务端提示 |
| :--- | :--- | :--- | :--- | :--- |

#### 3.2.2 系统健壮性问题

风险定义: 特殊输入导致服务端抛出异常 (Code 500)，可能暴露堆栈信息。

| 接口路径 (URL) | 方法 | 测试类型 | Payload (复现参数) | 实际业务码 | 服务端提示 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `/common/uploads` | POST | basic_auth | multipart/form-data (files) | 500 | Cannot invoke "java.util.List.iterator()" because "files" is null |
| `/system/dept/list/exclude/{deptId}` | GET | basic_auth | path参数={deptId} | 500 | 请求参数类型不匹配，参数[deptId]要求类型为：'java.lang.Long'，但输入值为：'{deptId}' |
| `/login` | POST | basic_auth | {"username":"test","password":"test"} | 500 | 用户不存在/密码错误 |
| `/system/user/profile/avatar` | POST | basic_auth | multipart/form-data | 500 | Current request is not a multipart request |
| `/register` | POST | basic_auth | test_payload | 500 | 当前系统未开启注册功能 |
| `/system/user/authRole/{userId}` | GET | basic_auth | path参数={userId} | 500 | 请求参数类型不匹配，参数[userId]要求类型为：'java.lang.Long'，但输入值为：'{userId}' |
| `/tool/gen/createTable` | POST | basic_auth | test_payload | 500 | 数据库结构异常 |
| `/tool/gen/preview/{tableId}` | GET | basic_auth | path参数={tableId} | 500 | 请求参数类型不匹配，参数[tableId]要求类型为：'java.lang.Long'，但输入值为：'{tableId}' |
| `/tool/gen/download/{tableName}` | GET | basic_auth | path参数={tableName} | 500 | Cannot invoke "com.ruoyi.generator.domain.GenTable.getSubTableName()" because "table" is null |
| `/tool/gen/genCode/{tableName}` | GET | basic_auth | path参数={tableName} | 500 | 系统预置文件下载，不能直接调用 |
| `/tool/gen/synchDb/{tableName}` | GET | basic_auth | path参数={tableName} | 500 | Cannot invoke "com.ruoyi.generator.domain.GenTable.getColumns()" because "table" is null |
| `/tool/gen/importTable` | POST | basic_auth | test_payload | 500 | SQL语法错误 |

#### 3.2.3 其他失败用例

| 接口路径 (URL) | 方法 | 测试类型 | 预期结果 | 实际结果 | 失败描述 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `/common/download` | GET | basic_auth | 200/下载成功 | 无JSON响应 | 响应为非JSON格式（可能是文件流） |
| `/common/download/resource` | GET | basic_auth | 200/下载成功 | 无JSON响应 | 响应为非JSON格式（可能是文件流） |
| `/monitor/logininfor/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/monitor/operlog/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/system/config/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/system/dict/data/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/system/dict/type/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/system/post/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/system/role/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/system/user/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/system/user/importData` | POST | basic_auth | 200/导入成功 | 500 | Excel文件格式错误 |
| `/system/user/importTemplate` | POST | basic_auth | 200/下载成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/monitor/job/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |
| `/monitor/jobLog/export` | POST | basic_auth | 200/导出成功 | 无JSON响应 | 响应为非JSON格式（可能是Excel文件） |

---

## 4. 安全结论与建议

### 4.1 鉴权逻辑分析

* **预期行为**: 未登录访问应返回 `Code: 401`，Msg: `"认证失败"`。  
* **实际发现**: 本次基准测试仅测试了携带有效Token的场景，未发现不符合预期的接口。  
* **测试覆盖率**: 100% (94/94个接口均携带有效Token进行测试)

### 4.2 修复建议

1. **路径参数替换优化**: 针对 `/api/{paramId}` 类型的接口，需要在测试脚本中自动替换占位符为有效ID值，避免类型不匹配错误。

2. **文件导出接口处理**: 
   - 建议为所有导出接口（export）添加标准响应头识别
   - 在测试脚本中增强对二进制流响应的自动识别能力

3. **异常捕获增强**: 对 500 错误接口增加全局异常处理 (GlobalExceptionHandler)，避免堆栈信息外泄。

4. **multipart 请求完善**: 
   - `/common/uploads` 接口需要正确构造多文件上传请求
   - `/system/user/profile/avatar` 需要确保 multipart 请求正确构造

5. **功能开关配置**: 
   - 明确 register 等功能的启用/禁用状态
   - 在配置文件中标注当前可用的功能模块

6. **数据库相关接口优化**: 代码生成器相关接口需要准备正确的数据库表结构，避免空指针异常

---

## 5. 附录

### 5.1 被保护的资源（管理员保护盾）

以下 34 个DELETE/PUT接口被自动跳过，防止破坏性操作：

| 序号 | 接口路径 | 方法 | 保护原因 |
| :--- | :--- | :--- | :--- |
| 1 | `/monitor/cache/clearCacheName/1` | DELETE | 敏感ID: 1 |
| 2 | `/monitor/cache/clearCacheKey/1` | DELETE | 敏感ID: 1 |
| 3 | `/monitor/cache/clearCacheAll` | DELETE | 全局操作 |
| 4 | `/monitor/logininfor/{infoIds}` | DELETE | 敏感ID |
| 5 | `/monitor/logininfor/clean` | DELETE | 全局操作 |
| 6 | `/monitor/operlog/{operIds}` | DELETE | 敏感ID |
| 7 | `/monitor/operlog/clean` | DELETE | 全局操作 |
| 8 | `/monitor/online/1` | DELETE | 敏感ID: 1 |
| 9 | `/system/config/{configIds}` | DELETE | 敏感ID |
| 10 | `/system/config/refreshCache` | DELETE | 全局操作 |
| 11 | `/system/dept/1` | DELETE | 敏感ID: 1 |
| 12 | `/system/dict/data/{dictCodes}` | DELETE | 敏感ID |
| 13 | `/system/dict/type/{dictIds}` | DELETE | 敏感ID |
| 14 | `/system/dict/type/refreshCache` | DELETE | 全局操作 |
| 15 | `/system/menu/{menuId}` | DELETE | 敏感ID |
| 16 | `/system/notice/{noticeIds}` | DELETE | 敏感ID |
| 17 | `/system/post/{postIds}` | DELETE | 敏感ID |
| 18 | `/system/user/profile/updatePwd` | PUT | 敏感操作 |
| 19 | `/system/user/{userIds}` | DELETE | 敏感ID |
| 20 | `/system/user/resetPwd` | PUT | 敏感操作 |
| 21 | `/system/user/changeStatus` | PUT | 敏感操作 |
| 22 | `/system/user/authRole` | PUT | 敏感操作 |
| 23 | `/system/role/dataScope` | PUT | 敏感操作 |
| 24 | `/system/role/changeStatus` | PUT | 敏感操作 |
| 25 | `/system/role/{roleIds}` | DELETE | 敏感ID |
| 26 | `/system/role/authUser/cancel` | PUT | 敏感操作 |
| 27 | `/system/role/authUser/cancelAll` | PUT | 敏感操作 |
| 28 | `/system/role/authUser/selectAll` | PUT | 敏感操作 |
| 29 | `/tool/gen/{tableIds}` | DELETE | 敏感ID |
| 30 | `/monitor/job/changeStatus` | PUT | 敏感操作 |
| 31 | `/monitor/job/run` | PUT | 敏感操作 |
| 32 | `/monitor/job/{jobIds}` | DELETE | 敏感ID |
| 33 | `/monitor/jobLog/{jobLogIds}` | DELETE | 敏感ID |
| 34 | `/monitor/jobLog/clean` | DELETE | 全局操作 |

### 5.2 测试环境信息

- Base URL: http://192.168.142.146/
- API 前缀: /prod-api
- 技术栈: Java + Spring Boot
- 源码路径: e:\project\Costric\RuoYi-Vue
- Java 文件: 260 个
- JS/Vue 文件: 171 个

---

**报告生成**: AI-DevSecOps-Bot  
**报告版本**: v1.0  
**测试日期**: 2026-01-04